#1. App升级时, 遇到数据库版本升级导致的崩溃

因为是数据库相关的, 所以在iOS & Android 都会出现这个问题.

大致的情况是, 在App的某个版本升级时, 发现需要在之前的数据库中 添加一个表 或者在某个表中添加额外的字段, 这时候, 如果你没有对数据库进行升级时, 在App操作最新的数据表或者字段时可能导致App崩溃.

当时App的升级是我做的嘛, 也没想到会出现这个问题, 后来我另一个同事就因为需求又在新的版本中给某个表添加了另外的数字段, 还是某个表来着. 升级以后, 只要一点击到需要访问相关的本地数据库就崩溃了, 但是好玩的是, 添加字段的那个同事完成之后是没问题的, 就是一到升级就死了, 然后因为升级是我做的嘛, 没办法既然是升级之后出现的问题, 那我当然要看看.

我首先就复现问题嘛, 复现了问题之后你就看问题出在哪, 一看, 问题是出在一个字符串调用.count方法时的空指针问题, 比如某个用户发表了一条评论, 我们现实就显示前面的20个以内的字符. 然后那个同事就说了, 不对啊, 这个字段我刚加的, 而且测试账号是有值的啊.

那我们肯定会想到是不是数据库的问题, 然后我们就这么的分析啊, 百度啊, 然后才发现是数据库没有更新

但是这方面的知识, 我们之前没接触过啊, 那就只能百度看有没有人也遇到这样的问题, 一搜一大堆, 解决问题也一大堆, 有人就说了, 直接删除原来的, 全部从新创建, 但这显然不适合我们啊, 我们保存了用户的登录, 有自动登录功能, 你总不能每次升级以后都要用户从新登录吧, 那我们就要找那些符合我们这种情况的解决方案, 弄懂了, 然后根据我们的情况, 自己解决.









  



